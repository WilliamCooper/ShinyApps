<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Spectral Analysis Notes</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- html --> 
<meta name="src" content="SpecAnalysis.tex"> 
<link rel="stylesheet" type="text/css" href="SpecAnalysis.css"> 
</head><body 
><!--l. 131--><p class="noindent" ><span id="textcolor1"><span 
class="eccc1440-"><span 
class="small-caps">e</span><span 
class="small-caps">a</span><span 
class="small-caps">r</span><span 
class="small-caps">t</span><span 
class="small-caps">h</span> <span 
class="small-caps">o</span><span 
class="small-caps">b</span><span 
class="small-caps">s</span><span 
class="small-caps">e</span><span 
class="small-caps">r</span><span 
class="small-caps">v</span><span 
class="small-caps">i</span><span 
class="small-caps">n</span><span 
class="small-caps">g</span> <span 
class="small-caps">l</span><span 
class="small-caps">a</span><span 
class="small-caps">b</span><span 
class="small-caps">o</span><span 
class="small-caps">r</span><span 
class="small-caps">a</span><span 
class="small-caps">t</span><span 
class="small-caps">o</span><span 
class="small-caps">r</span><span 
class="small-caps">y</span></span></span>
<!--l. 131--><p class="noindent" ><span id="textcolor2"><span 
class="ecsi-1200">Memorandum:</span></span>____________________________________________________________________________
<p 
class="leftline">                                                                 26 November 2017                                          </p>
<div class="tabular"> <table id="TBL-1" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-1-1g"><col 
id="TBL-1-1"><col 
id="TBL-1-2"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-1-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-1-1"  
class="td11"><span id="textcolor3"><span 
class="eccc1200-"><span 
class="small-caps">t</span><span 
class="small-caps">o</span><span 
class="small-caps">:</span></span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-1-2"  
class="td11">File           </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-2-1"  
class="td11"><span id="textcolor4"><span 
class="eccc1200-"><span 
class="small-caps">f</span><span 
class="small-caps">r</span><span 
class="small-caps">o</span><span 
class="small-caps">m</span><span 
class="small-caps">:</span></span></span> </td> <td  style="white-space:nowrap; text-align:left;" id="TBL-1-2-2"  
class="td11">Al Cooper</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-3-1"  
class="td11"><span id="textcolor5"><span 
class="eccc1200-"><span 
class="small-caps">s</span><span 
class="small-caps">u</span><span 
class="small-caps">b</span><span 
class="small-caps">j</span><span 
class="small-caps">e</span><span 
class="small-caps">c</span><span 
class="small-caps">t</span><span 
class="small-caps">:</span></span></span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-3-2"  
class="td11">        </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-4-1"  
class="td11"> </td>
</tr></table></div>
<div class="maketitle">
                                                                                         
                                                                                         
                                                                                         
                                                                                         

<h2 class="titleHead">Spectral Analysis Notes</h2>
<div class="author" ></div><br />
<div class="date" ><span 
class="ptmr8t-x-x-144">November 26, 2017</span></div>
</div>
<!--l. 151--><p class="noindent" >This is an addition to the &#8220;RSessions&#8221; tutorial that provided guidance on getting started with analyzing
aircraft data using R and the &#8220;Ranadu&#8221; package of routines. This is more detailed than the other tutorials
in those sessions and attempts to be reasonably thorough in its review of spectral analysis using R,
although it (as of yet) does not include discussion of coherence, phase, and the cross-spectrum and
co-spectrum.
<!--l. 159--><p class="noindent" >The focus here is on spatio-temporal data, data sets where the variables have associated locations and
times. Examples are a time series constructed from consecutive measurements at a fixed location and a set
of simultaneous (or &#8220;synoptic&#8221;) measurements made at various locations. Standard statistical
characteristics like the mean, variance, and standard deviation represent the data sets, but it is also useful
to describe their internal character by considering two additional characteristics: (i) How are the
measurements correlated in time or space (respectively), and (ii) Can the measured fields be represented in
terms of sums of frequency or wavelength components? The former leads to the autocovariance and
autocorrelation functions and the latter to decomposition into a variance spectrum. These two ways of
characterizing the data turn out to be complementary in the sense that knowledge of either one can be used
to generate the other.
<!--l. 174--><p class="noindent" >These notes focus on the second display, often called a &#8220;power spectrum,&#8221; that shows how the variance in
a signal is distributed as a function of frequency or wavelength. The terms &#8220;variance spectrum&#8221; (for the
plot) and &#8220;spectral variance&#8221; (for the plotted variable) are preferred here because the display
is used frequently where the variance does not represent power as it did in early electrical
                                                                                         
                                                                                         
applications.<span class="footnote-mark"><a 
href="SpecAnalysis2.html#fn1x0"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-2f1"></a> 
The key concept reflected in the variance spectrum is that such spatio-temporal series can be decomposed
into independent components that vary in frequency and/or wavelength. The Fourier series is often used
and has valuable associated properties of orthogonality and completeness so that individual components
can be regarded as independent and the set of such components can represent the observed series without
error. However, the early focus here is on how to interpret the resulting variance spectrum rather than on
how to construct it. Other sources (e.g., <a 
href="https://drive.google.com/open?id=1I1q8WTBzMKJGJ8ylRGmmQ8NwcCSgjwST" >this linked URL</a>) can be consulted regarding how to construct
such a representation and some of that material will be repeated here for completeness, but those more
interested in using and interpreting the variance spectrum can skip those sections (marked with
asterisks).
<h3 class="sectionHead"><span class="titlemark">1    </span> <a 
 id="x1-10001"></a>Representing the Variance Spectrum</h3>
<!--l. 207--><p class="noindent" >The variance spectrum can be regarded as the derivative of the cumulative variance function (CV). To
simplify the discussion, consider a special case of a time series, maybe the measurements at discrete
times of a component of the wind at a fixed location. The natural decomposition is then in
terms of frequency <span 
class="zptmcm7m-x-x-120">&#x03BD;</span>, and the cumulative variance function can be defined as the contributions
to the total variance in the measurements from contributions from frequencies smaller than
<span 
class="zptmcm7m-x-x-120">&#x03BD;</span>:
<table 
class="equation"><tr><td><a 
 id="x1-1001r1"></a>
<center class="math-display" >
<img 
src="SpecAnalysis0x.png" alt="         &#x222B; &#x03BD;
CV (&#x03BD; ) =    P(&#x03BD;&#x2032;)d&#x03BD;&#x2032;
          0
" class="math-display" ></center></td><td class="equation-label">(1)</td></tr></table>
                                                                                         
                                                                                         
<!--l. 218--><p class="nopar" >
<!--l. 220--><p class="noindent" >Here <span 
class="zptmcm7m-x-x-120">P</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">&#x03BD;</span><span 
class="zptmcm7t-x-x-120">) </span>is the derivative of CV and is the variance spectrum. In some specified interval <span 
class="zptmcm7m-x-x-120">&#x03B4;&#x03BD; </span>about <span 
class="zptmcm7m-x-x-120">&#x03BD;</span>, the
contribution to the variance is <span 
class="zptmcm7m-x-x-120">P</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">&#x03BD;</span><span 
class="zptmcm7t-x-x-120">)</span><span 
class="zptmcm7m-x-x-120">&#x03B4;&#x03BD;</span>. It is usually the case that observations can only provide estimates
of <span 
class="zptmcm7m-x-x-120">P</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">&#x03BD;</span><span 
class="zptmcm7t-x-x-120">) </span>for discrete frequencies, but generalization to infinitesimally spaced frequencies allows us in
concept to regard <span 
class="zptmcm7m-x-x-120">P</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">&#x03BD;</span><span 
class="zptmcm7t-x-x-120">) </span>as a continuous function. When extended to infinitely large frequency, (1) shows
that the integral of the variance spectrum will give the total variance, which is the limit of CV<span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">&#x03BD;</span><span 
class="zptmcm7t-x-x-120">) </span>as <span 
class="zptmcm7m-x-x-120">&#x03BD;</span>
tends to infinity.
<!--l. 230--><p class="noindent" >Representing the variance spectrum as the derivative of (1) has the additional benefit that transformation
to representations in terms of other variables is straightforward. For example, if the time series arises from
repeated measurements from a moving platform like an aircraft, and if the air is at rest, the wavelength <span 
class="zptmcm7m-x-x-120">&#x03BB;</span>
of a fluctuation is related to the frequency of that fluctuation by <span 
class="zptmcm7m-x-x-120">&#x03BB;&#x03BD; </span><span 
class="zptmcm7t-x-x-120">= </span><span 
class="zptmcm7m-x-x-120">V </span>where V is the speed of the
moving platform. Then another variance &#8220;spectrum&#8221; (in quotes because this is no longer the representation
of the variance in terms of frequency, as implied by &#8220;spectrum&#8221;) can be defined as <span 
class="zptmcm7m-x-x-120">P</span><sub><span 
class="zptmcm7m-x-x-90">&#x03BB;</span></sub><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">&#x03BB;</span><span 
class="zptmcm7t-x-x-120">) </span>such
that
<table 
class="equation"><tr><td><a 
 id="x1-1002r2"></a>
<center class="math-display" >
<img 
src="SpecAnalysis1x.png" alt="            &#x221E;&#x222B;
CV (V&#x2215;&#x03BB; ) =   P&#x03BB;(&#x03BB; &#x2032;)d&#x03BB; &#x2032;

            &#x03BB;
" class="math-display" ></center></td><td class="equation-label">(2)</td></tr></table>
<!--l. 243--><p class="nopar" >
<!--l. 245--><p class="noindent" >Differentiating (1) and (2) at corresponding values of <span 
class="zptmcm7m-x-x-120">&#x03BB; </span>and <span 
class="zptmcm7m-x-x-120">&#x03BD; </span><span 
class="zptmcm7t-x-x-120">= </span><span 
class="zptmcm7m-x-x-120">V&#x2215;&#x03BB; </span>leads to the relationship between the
spectral densities in terms of frequency and of wavelength:<br 
class="newline" />
<table 
class="equation"><tr><td><a 
 id="x1-1003r3"></a>
<center class="math-display" >
                                                                                         
                                                                                         
<img 
src="SpecAnalysis2x.png" alt="        dCV     dCV  d&#x03BD;          V
P&#x03BB;(&#x03BB;) = -----=  --------= - P(&#x03BD; )-2-
         d&#x03BB;      d&#x03BD;  d&#x03BB;          &#x03BB;
" class="math-display" ></center></td><td class="equation-label">(3)</td></tr></table>
<!--l. 250--><p class="nopar" >
<!--l. 252--><p class="noindent" >Another useful relationship can be obtained by expressing the cumulative variance function in terms of the
logarithm of the frequency. Then, to avoid the infinity that arises at zero frequency, express the cumulative
variance from some minimum frequency <span 
class="zptmcm7m-x-x-120">&#x03BD;</span><sub><span 
class="zptmcm7m-x-x-90">min</span></sub> to <span 
class="zptmcm7m-x-x-120">&#x03BD;</span>:<br 
class="newline" />
<table 
class="equation"><tr><td><a 
 id="x1-1004r4"></a>
<center class="math-display" >
<img 
src="SpecAnalysis3x.png" alt="              log&#x222B;(&#x03BD;)
CV (log&#x03BD; ) =       P *(log &#x03BD;&#x2032;d log&#x03BD; &#x2032;)

            log(&#x03BD;min)
" class="math-display" ></center></td><td class="equation-label">(4)</td></tr></table>
<!--l. 258--><p class="nopar" >
<!--l. 260--><p class="noindent" >Differentiating gives <br 
class="newline" />
<table 
class="equation"><tr><td><a 
 id="x1-1005r5"></a>
<center class="math-display" >
<img 
src="SpecAnalysis4x.png" alt="-dCV---= P *(log &#x03BD;) = dCV----d&#x03BD;---= &#x03BD;P (&#x03BD;)
d log&#x03BD;                d&#x03BD;  dlog &#x03BD;
" class="math-display" ></center></td><td class="equation-label">(5)</td></tr></table>
                                                                                         
                                                                                         
<!--l. 263--><p class="nopar" >
<!--l. 265--><p class="noindent" >This shows that <span 
class="zptmcm7m-x-x-120">&#x03BD;P</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">&#x03BD;</span><span 
class="zptmcm7t-x-x-120">) </span>is a spectral density function for variance in terms of the logarithm of
frequency. That makes this density function particularly suited to plots that use logarithmic
abcissa coordinates because then equal areas represent equal contributions to the variance from
those intervals. Note also that <span 
class="zptmcm7m-x-x-120">&#x03BD;P</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">&#x03BD;</span><span 
class="zptmcm7t-x-x-120">) = </span><span 
class="zptmcm7y-x-x-120">-</span><span 
class="zptmcm7m-x-x-120">&#x03BB;P</span><sub><span 
class="zptmcm7m-x-x-90">&#x03BB;</span></sub><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">&#x03BB;</span><span 
class="zptmcm7t-x-x-120">) </span>so a secondary axis can represent <span 
class="zptmcm7m-x-x-120">&#x03BB;P</span><sub><span 
class="zptmcm7m-x-x-90">&#x03BB;</span></sub><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">&#x03BB;</span><span 
class="zptmcm7t-x-x-120">)</span>
on a plot of <span 
class="zptmcm7m-x-x-120">&#x03BD;P</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">&#x03BD;</span><span 
class="zptmcm7t-x-x-120">)</span>. For these reasons, and also because it tends to compress plots vertically
that cover large ranges in frequency, <span 
class="zptmcm7m-x-x-120">&#x03BD;P</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">&#x03BD;</span><span 
class="zptmcm7t-x-x-120">) </span>will be used in most of the examples in these
notes.
<!--l. 275--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">2    </span> <a 
 id="x1-20002"></a>Interpreting the Variance Spectrum</h3>
<!--l. 277--><p class="noindent" >The spectral variance can be regarded as a continuous function, but in practice there are limitations to its
determination. This section discusses some of those limitations, notably the Nyquist frequency, and then
presents some examples with interpretation.
<!--l. 282--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">2.1    </span> <a 
 id="x1-30002.1"></a>Limitations when determining the variance spectrum</h4>
<!--l. 284--><p class="noindent" >Some important characteristics of the variance spectrum are the following:
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-3002x1"><span 
class="ptmri8t-x-x-120">The Nyquist frequency: </span>For a time series sampled at increments <span 
class="zptmcm7t-x-x-120">&#x0394;</span><span 
class="zptmcm7m-x-x-120">t </span>in time and spanning a
      duration <span 
class="zptmcm7m-x-x-120">T </span>in time, the first limitation is that the frequency components entering the variance
      spectrum  cannot  be  determined  for  frequencies  higher  than  <span 
class="zptmcm7t-x-x-120">1</span><span 
class="zptmcm7m-x-x-120">&#x2215;</span><span 
class="zptmcm7t-x-x-120">(2&#x0394;</span><span 
class="zptmcm7m-x-x-120">t</span><span 
class="zptmcm7t-x-x-120">)</span>,  called  the  Nyquist
      frequency,  because  at  least  two  observations  separated  by  <span 
class="zptmcm7t-x-x-120">&#x0394;</span><span 
class="zptmcm7m-x-x-120">t </span>are  needed  to  resolve  this
      highest frequency.
      </li>
      <li 
  class="enumerate" id="x1-3004x2"><span 
class="ptmri8t-x-x-120">Aliasing:  </span>If  higher  frequencies  are  present  they  can  contaminate  the  estimated  spectral
      density at lower frequencies through a process called aliasing.
      </li>
      <li 
  class="enumerate" id="x1-3006x3"><span 
class="ptmri8t-x-x-120">The low-frequency limit: </span>It becomes difficult to resolve frequencies smaller than 1/<span 
class="zptmcm7m-x-x-120">T </span>. The
      common way of estimating the variance spectrum uses Fourier transforms and, because that
      inherently assumes that the function is periodic, this requires no components with frequency
      lower than <span 
class="zptmcm7t-x-x-120">1</span><span 
class="zptmcm7m-x-x-120">&#x2215;T </span>.<span class="footnote-mark"><a 
href="SpecAnalysis3.html#fn2x0"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-3007f2"></a> 
                                                                                         
                                                                                         
      </li>
      <li 
  class="enumerate" id="x1-3009x4"><span 
class="ptmri8t-x-x-120">Trend removal. </span>Another problem that arises from the assumption that the variable is periodic
      outside  the  period  (0,  <span 
class="zptmcm7m-x-x-120">T </span>)  is  that,  if  there  is  a  linear  increase  in  the  variable  with  time,
      this becomes resolved as a triangular wave with components that contaminate the spectral
      density.  For  this  reason,  any  trend  in  the  data  is  normally  removed  before  the  variance
      spectrum is estimated. The mean can also be removed, and this is sometimes useful when
      numerical precision is a problem with the calculation.
      </li>
      <li 
  class="enumerate" id="x1-3011x5"><span 
class="ptmri8t-x-x-120">Normalization: </span>As used in this note, the variance spectrum is normalized so that the integral
      over positive frequencies gives the variance. Sometimes the normalization is such that the
      integral over both negative and positive frequencies gives the variance, so determining the
      normalization used is important when examining a plotted variance spectrum.</li></ol>
<!--l. 317--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">2.2    </span> <a 
 id="x1-40002.2"></a>Introductory examples</h4>
<!--l. 320--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-40011"></a>
                                                                                         
                                                                                         
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;1:  </span><span  
class="content">Three  time  series  of  hourly  values  spanning  one  week.  (top)  A  sequence  of  values
generated using a Gaussian random-number generator producing deviations about a mean of 0 with
a standard deviation of 1; (middle) Surface pressure measurements from Denver CO for one week;
(bottom) Temperature measurements from Denver CO for one week.</span></div><!--tex4ht:label?: x1-40011 -->
                                                                                         
                                                                                         
<!--l. 327--><p class="noindent" ></div><hr class="endfigure">
<!--l. 332--><p class="noindent" >Again for simplicity first focus on a time series. The following plot (Fig.&#x00A0;<a 
href="#x1-40011">1<!--tex4ht:ref: fig:random-time-series --></a> shows three time series that
have very different character:
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-4003x1">The top series shows a series of values generated from random numbers generated from a
      normal distribution having mean zero and unit standard deviation. Knowing the preceding
      value of the variable does not provide any information on the next measurement; sequential
      measurements  are  completely  uncorrelated.  A  similar  series  generated  using  uniformly
      distributed random numbers between -1 and 1 looks different because all values remain in
      the range from -1 to 1, but the randomness of the values still provides no serial correlations
      in  the  time  series.  Both  ways  of  generating  a  time  series  produce  &#8220;white  noise&#8221;,  a  term
      used to describe a signal where the spectral density is a constant function of frequency and
      successive values in the time series are uncorrelated.
      </li>
      <li 
  class="enumerate" id="x1-4005x2">The middle time series shows one week of sea-level pressure measurements. There is strong
      correlation among the measurements, such that knowledge of preceding measurements can
      be used to predict the next measurement with less than the sample variance.
      </li>
      <li 
  class="enumerate" id="x1-4007x3">The  bottom  time  series,  temperature  measurements,  shows  evidence  of  a  daily  cycle  in
      addition to important serial correlations. The spectral variance should highlight this daily
      cycle. (It will be present in the pressure measurements also, although with less prominence.)</li></ol>
<!--l. 358--><p class="noindent" ><hr class="figure"><div class="figure" 
><a 
 id="x1-40082"></a>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;2:  </span><span  
class="content">Autocorrelation  functions  for  the  9.5-y  time  series  of  variables  like  those  in  the
preceding figure.</span></div><!--tex4ht:label?: x1-40082 -->
<!--l. 365--><p class="noindent" ></div><hr class="endfigure">
<!--l. 370--><p class="noindent" >The autocorrelation functions for these series have distinctly different characteristics. The preceding figure
was generated from one week of data, for the next plots about 9.5 years of similar observations will be
used. The resulting autocorrelation functions are shown in Fig.<a 
href="#x1-40082">2<!--tex4ht:ref: fig:acf --></a>. For the white-noise sample, only the
lag-zero value is different from zero, which reflects that there is no correlation between consecutive
random numbers at any lag. The bottom plot for temperature, however, shows a dominating
diurnal cycle. If plotted for longer time differences, it also shows a prominent annual cycle.
The middle plot for sea-level pressure and the bottom plot for temperature show a significant
correlation over a period of a few days, reflecting the important influence of passing large-scale
weather systems. The variance spectrum for pressure also displays an annual and a diurnal
cycle, but the diurnal cycle is barely perceptible in this plot. It will be revealed in the variance
spectrum.
<!--l. 387--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-40093"></a>
                                                                                         
                                                                                         
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;3: </span><span  
class="content">Variance spectra corresponding to the three cases presented in the preceding two figures.
The dotted-black vertical lines mark the frequency corresponding to a period of one year. The
white line in all plot is the result of averaging in 50 logarithmically spaced bins in frequency. In
the middle plot for pressure, the red line shows the corresponding averaged spectrum constructed
from the altimeter setting, with appropriate change of units.</span></div><!--tex4ht:label?: x1-40093 -->
                                                                                         
                                                                                         
<!--l. 394--><p class="noindent" ></div><hr class="endfigure">
<!--l. 399--><p class="noindent" >The autocovariance function (the autocorrelation multiplied by the total variance) is related to
the variance spectrum; they are Fourier transforms of each other. The variance spectra are
shown in Fig.&#x00A0;<a 
href="#x1-40093">3<!--tex4ht:ref: fig:varspec --></a>. The variance spectrum for white noise, shown in the top plot, is a constant
function of frequency, but there is considerable variability in the estimated spectral variance
because of uncertainty in the individual estimates. The white dashed line in that plot shows the
result of averaging in bins to reduce that uncertainty, and where the uncertainty is small (for
frequencies above about 0.1 day<sup><span 
class="zptmcm7y-x-x-90">-</span><span 
class="zptmcm7t-x-x-90">1</span></sup>) the spectral variance has a value of about 0.083. The standard
deviation of the values producing this spectrum is 1, so the expected value of the spectral
variance is 1/12=0.08333. This relationship can sometimes be used to estimate the random error
in a measurement, because a random error of <span 
class="zptmcm7m-x-x-120">&#x03C3; </span>will produce a constant contribution to the
spectral variance of <span 
class="zptmcm7m-x-x-120">&#x03C3;</span><sup><span 
class="zptmcm7t-x-x-90">2</span></sup><span 
class="zptmcm7m-x-x-120">&#x2215;</span><span 
class="zptmcm7t-x-x-120">12</span>. In cases where the high-frequency portion of the spectral variance
assumes a constant value, the random error can thus be determined from the spectral variance
there.
<!--l. 417--><p class="noindent" >The middle plot shows the variance spectrum for hourly measurements of sea-level pressure and, as the
red dashed line, the altimeter setting. There are prominent spikes in the unaveraged spectrum with
frequencies corresponding to (1/24)&#x00A0;h<sup><span 
class="zptmcm7y-x-x-90">-</span><span 
class="zptmcm7t-x-x-90">1</span></sup> and multiples of this frequency extending to at least
ten times this frequency. These arise from the atmospheric tides of the diurnal cycle, which
instead of a simple sine wave must instead be represented by many &#8220;harmonics&#8221; of the basic
frequency.<span class="footnote-mark"><a 
href="SpecAnalysis4.html#fn3x0"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-4010f3"></a> 
The annual cycle also makes a prominent contribution to the spectral variance. Unlike the
sea-level pressure, the altimeter setting is not adjusted by averaging the temperature from
the previous 12 h to use for extrapolation to sea level. The higher variance in the sea-level
pressure suggests that the altimeter setting is a better variable to use for spectral analysis, even
though it is recorded with lower resolution (0.01&#x00A0;inHg or 0.3&#x00A0;hPa vs 0.1&#x00A0;hPa for the sea-level
pressure).<span class="footnote-mark"><a 
href="SpecAnalysis5.html#fn4x0"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-4011f4"></a> 
In the case of the measurements of temperature, the diurnal cycle is very prominent (before
averaging) and the contribution from the annual cycle is concentrated more on the period of 365.25
days.
                                                                                         
                                                                                         
<h3 class="sectionHead"><span class="titlemark">3    </span> <a 
 id="x1-50003"></a>Generating Plots of the Variance Spectrum*</h3>
<!--l. 448--><p class="noindent" >It is beyond the scope of this note to describe the detailed construction of the variance spectrum, although
a document at <a 
href="https://drive.google.com/open?id=1I1q8WTBzMKJGJ8ylRGmmQ8NwcCSgjwST" >this linked URL</a> provides such details. Some of that material is presented in the next
sub-section below, but those wanting to skip directly to instructions on how to use &#8220;R&#8221; to generate the
variance spectrum can skip to the following section.
<!--l. 455--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.1    </span> <a 
 id="x1-60003.1"></a>Theoretical basis for the periodogram</h4>
<!--l. 457--><p class="noindent" >The basic tool used most often for spectral analysis is the Fourier series. This representation is particularly
suited to periodic functions and indeed makes the assumption that the series is periodic. Consider a
function that repeats with period <span 
class="zptmcm7m-x-x-120">T, </span>such that <span 
class="zptmcm7m-x-x-120">f</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">t</span><span 
class="zptmcm7t-x-x-120">) = </span><span 
class="zptmcm7m-x-x-120">f</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">t </span><span 
class="zptmcm7t-x-x-120">+</span><span 
class="zptmcm7m-x-x-120">T </span><span 
class="zptmcm7t-x-x-120">) = </span><span 
class="zptmcm7m-x-x-120">f</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">t </span><span 
class="zptmcm7t-x-x-120">+2</span><span 
class="zptmcm7m-x-x-120">T </span><span 
class="zptmcm7t-x-x-120">) =</span> <img 
src="SpecAnalysis6x.png" alt="&#x22C5;&#x22C5;&#x22C5;"  class="@cdots" ><span style="margin-left:0.3em" class="thinspace"></span>. We seek to represent this
function by <span 
class="zptmcm7m-x-x-120">f</span><sup><span 
class="zptmcm7y-x-x-90">*</span></sup><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">t</span><span 
class="zptmcm7t-x-x-120">)</span>, a superposition of sine and cosine waves with various frequencies having amplitudes
{<span 
class="zptmcm7m-x-x-120">a</span><sub><span 
class="zptmcm7m-x-x-90">k</span></sub>} and {<span 
class="zptmcm7m-x-x-120">b</span><sub><span 
class="zptmcm7m-x-x-90">k</span></sub>}:
<!--l. 465--><p class="noindent" >
<table 
class="align">
                         <tr><td 
class="align-odd"><span 
class="zptmcm7m-x-x-120">f</span><sup><span 
class="zptmcm7y-x-x-90">*</span></sup><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">t</span><span 
class="zptmcm7t-x-x-120">)</span></td>                         <td 
class="align-even"> <span 
class="zptmcm7t-x-x-120">= </span><span 
class="zptmcm7m-x-x-120">a</span><sub><span 
class="zptmcm7t-x-x-90">0</span></sub> <span 
class="zptmcm7t-x-x-120">+</span><span 
class="zptmcm7v-x-x-120">&#x2211;</span><sub>
<span 
class="zptmcm7m-x-x-90">k</span><span 
class="zptmcm7t-x-x-90">=1</span></sub><sup><span 
class="zptmcm7y-x-x-90">&#x221E;</span></sup><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">a</span><sub>
<span 
class="zptmcm7m-x-x-90">k</span></sub><span 
class="zptmcm7t-x-x-120">cos</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">&#x03C9;</span><sub><span 
class="zptmcm7m-x-x-90">k</span></sub><span 
class="zptmcm7m-x-x-120">t</span><span 
class="zptmcm7t-x-x-120">)+</span><span 
class="zptmcm7m-x-x-120">b</span><sub><span 
class="zptmcm7m-x-x-90">k</span></sub><span 
class="zptmcm7t-x-x-120">sin</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">&#x03C9;</span><sub><span 
class="zptmcm7m-x-x-90">k</span></sub><span 
class="zptmcm7m-x-x-120">t</span><span 
class="zptmcm7t-x-x-120">))</span></td>                                                  <td 
class="align-label"><a 
 id="x1-6001r6"></a>(6)
                         </td></tr><tr><td 
class="align-odd"> <span 
class="zptmcm7t-x-x-120">=</span></td>                            <td 
class="align-even"><span 
class="zptmcm7v-x-x-120">&#x2211;</span><sub><span 
class="zptmcm7m-x-x-90">k</span><span 
class="zptmcm7t-x-x-90">=</span><span 
class="zptmcm7y-x-x-90">-&#x221E;</span></sub><sup><span 
class="zptmcm7y-x-x-90">&#x221E;</span></sup><span 
class="zptmcm7m-x-x-120">c</span><sub>
<span 
class="zptmcm7m-x-x-90">k</span></sub><span 
class="zptmcm7m-x-x-120">e</span><sup><span 
class="zptmcm7m-x-x-90">i&#x03C9;</span><sub><span 
class="zptmcm7m-x-x-70">k</span></sub><span 
class="zptmcm7m-x-x-90">t</span></sup></td>                                                                          <td 
class="align-label"><a 
 id="x1-6002r7"></a>(7)                         </td></tr></table>
where the angular frequencies are<br 
class="newline" />
<table 
class="equation"><tr><td><a 
 id="x1-6003r8"></a>
                                                                                         
                                                                                         
<center class="math-display" >
<img 
src="SpecAnalysis7x.png" alt="&#x03C9;  =  2&#x03C0;&#x03BD;  = 2&#x03C0;kV--
  k      k     &#x03BB;k
" class="math-display" ></center></td><td class="equation-label">(8)</td></tr></table>
<!--l. 472--><p class="nopar" >
with the wavelengths <span 
class="zptmcm7m-x-x-120">&#x03BB;</span><sub><span 
class="zptmcm7m-x-x-90">k</span></sub> obtained from the frequencies <span 
class="zptmcm7m-x-x-120">&#x03BD;</span><sub><span 
class="zptmcm7m-x-x-90">k</span></sub> for observations over a period T. Where
the measurements are made during motion through the field with speed <span 
class="zptmcm7m-x-x-120">V </span>, the wavelengths
<span 
class="zptmcm7m-x-x-120">&#x03BB;</span><sub><span 
class="zptmcm7m-x-x-90">k</span></sub> are found from <span 
class="zptmcm7m-x-x-120">V </span><span 
class="zptmcm7t-x-x-120">= </span><span 
class="zptmcm7m-x-x-120">&#x03BD;</span><sub><span 
class="zptmcm7m-x-x-90">k</span></sub><span 
class="zptmcm7m-x-x-120">&#x03BB;</span><sub><span 
class="zptmcm7m-x-x-90">k</span></sub>. Alternately, if the field is a spatial field, the wavelength <span 
class="zptmcm7m-x-x-120">&#x03BB;</span><sub><span 
class="zptmcm7m-x-x-90">k</span></sub> is
the natural Fourier component and the representation in terms of the spatial coordinate <span 
class="zptmcm7m-x-x-120">s </span>is
<span 
class="zptmcm7m-x-x-120">f</span><sup><span 
class="zptmcm7y-x-x-90">*</span></sup><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">s</span><span 
class="zptmcm7t-x-x-120">) =</span> <span 
class="zptmcm7v-x-x-120">&#x2211;</span><sub><span 
class="zptmcm7m-x-x-90">k</span><span 
class="zptmcm7t-x-x-90">=</span><span 
class="zptmcm7y-x-x-90">-&#x221E;</span></sub><sup><span 
class="zptmcm7y-x-x-90">&#x221E;</span></sup><span 
class="zptmcm7m-x-x-120">c</span><sub><span 
class="zptmcm7m-x-x-90">k</span></sub><span 
class="zptmcm7m-x-x-120">e</span><sup><span 
class="zptmcm7m-x-x-90">i</span><span 
class="zptmcm7t-x-x-90">2</span><span 
class="zptmcm7m-x-x-90">&#x03C0;s&#x2215;&#x03BB;</span><sub><span 
class="zptmcm7m-x-x-70">k</span></sub></sup>.
<!--l. 481--><p class="noindent" >The coefficients <span 
class="zptmcm7m-x-x-120">c</span><sub><span 
class="zptmcm7m-x-x-90">k</span></sub> can be determined from<br 
class="newline" />
<table 
class="equation"><tr><td><a 
 id="x1-6004r9"></a>
<center class="math-display" >
<img 
src="SpecAnalysis8x.png" alt="        T&#x222B; &#x2215;2
c  = 1-     f(t)e-i&#x03C9;ktdt
 k   T
       -T&#x2215;2
" class="math-display" ></center></td><td class="equation-label">(9)</td></tr></table>
<!--l. 484--><p class="nopar" >
as can be demonstrated by substituting <span 
class="zptmcm7m-x-x-120">f</span><sup><span 
class="zptmcm7y-x-x-90">*</span></sup><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">t</span><span 
class="zptmcm7t-x-x-120">) </span>for <span 
class="zptmcm7m-x-x-120">f</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">t</span><span 
class="zptmcm7t-x-x-120">) </span>in (<a 
href="#x1-6004r9">9<!--tex4ht:ref: eq:coef-ck --></a>) and using the orthogonality relationships
for the exponential functions (or equivalently for sine and cosine functions). If there are <span 
class="zptmcm7m-x-x-120">N</span>
observations in the time series, <span 
class="zptmcm7m-x-x-120">N </span>coefficients in the representation (<a 
href="#x1-6002r7">7<!--tex4ht:ref: eq:complex-form --></a>) can match those observations
exactly.
                                                                                         
                                                                                         
<!--l. 492--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.2    </span> <a 
 id="x1-70003.2"></a>Generating the periodogram using &#8220;R&#8221;</h4>
<!--l. 495--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-70014"></a>
                                                                                         
                                                                                         
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;4: </span><span  
class="content">Periodogram for the hourly time series of sea-level pressure measurements at Denver,
CO, from July 1 2006 to 31 December 2015.</span></div><!--tex4ht:label?: x1-70014 -->
                                                                                         
                                                                                         
<!--l. 502--><p class="noindent" ></div><hr class="endfigure">
<!--l. 507--><p class="noindent" >In the approach to spectral analysis that uses the Fourier transform, the initial step is to determine the
Fourier coefficients that reconstruct the observed time series and from that estimate the spectral variance
at a set of discrete frequencies. The plot of those estimates is called a periodogram and an example is
shown in Fig.&#x00A0;<a 
href="#x1-70014">4<!--tex4ht:ref: fig:periodogram --></a>. This was generated by these R commands:
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 513--><p class="noindent" ><span 
class="ectt-1200">ts2</span><span 
class="ectt-1200">&#x00A0;&#x003C;-</span><span 
class="ectt-1200">&#x00A0;ts(DIA$SLVP,</span><span 
class="ectt-1200">&#x00A0;frequency=24)</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;##</span><span 
class="ectt-1200">&#x00A0;construct</span><span 
class="ectt-1200">&#x00A0;time-series</span><span 
class="ectt-1200">&#x00A0;object</span>
      <!--l. 516--><p class="noindent" ><span 
class="ectt-1200">spectrum(ts2)</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;##</span><span 
class="ectt-1200">&#x00A0;spectrum</span><span 
class="ectt-1200">&#x00A0;is</span><span 
class="ectt-1200">&#x00A0;part</span><span 
class="ectt-1200">&#x00A0;of</span><span 
class="ectt-1200">&#x00A0;stats::</span></dd></dl>
<!--l. 518--><p class="noindent" >In addition to generating the plot, &#8220;spectrum()&#8221; also returns values for the estimates of spectral variance as
a function of frequency so that further manipulation is possible. This is usually necessary because the
estimates in the periodogram have large associated uncertainty and will benefit from some type of
averaging that reduces the variance. It is also usually preferable to construct logarithmic displays of the
variance spectrum.
<!--l. 526--><p class="noindent" >When using the &#8220;spectrum()&#8221; function, it is important to recognize that the periodogram returned is
two-sided, so values of the &#8220;spec&#8221; variable as returned by spectrum() should be multiplied by two to
match the normalization otherwise used in this note.
<h4 class="subsectionHead"><span class="titlemark">3.3    </span> <a 
 id="x1-80003.3"></a>Reducing the variance in the estimates of spectral variance</h4>
<!--l. 533--><p class="noindent" >This reduction refers to the variance in the estimates and should not be confused with the variance in the
time series. A property of the periodogram is that the variance in the individual estimates is
equal to the magnitude of the estimate itself, so the result appears to be very noisy. There are
many ways to smooth the resulting spectrum and reduce this variance in the estimates. They
include:
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-8002x1">Moving smoothing functions. A common choice, implemented in &#8220;spectrum()&#8221; as discussed
      below,  is  the  Daniell  smoother,  which  in  effect  applies  a  moving-average  smoother.
      This  can  be  introduced  into  the  estimate  of  spectral  variance  by  including  the  argument
      &#8220;spans=c(i1,i2,...)&#8221;  in  the  call  to  &#8220;spectrum()&#8221;,  where  the  arguments  {i1,i2,i3}  are  odd
      integers  determining  the  span  of  consecutive  moving-average  smoothers  applied  to  the
      resulting spectrum. Large numbers give more smoothing at the expense of loss of frequency
      resolution.  In  the  plots  produced  by  &#8220;spectrum()&#8221;,  an  error  bar  plotted  at  the  top  right
      indicates the uncertainty in the estimate of the spectral variance. The reduction in variance
      is often substantial; for a moving average, the reduction would be expected to be inversely
      proportional to the square root of the number of estimates averaged together.
                                                                                         
                                                                                         
      </li>
      <li 
  class="enumerate" id="x1-8004x2">Segmenting  and  averaging  the  resulting  spectra.  The  time  series  can  be  subdivided  into
      segments, which may be overlapping, and the estimates of spectral variance obtained from
      those  individual  segments  can  then  be  averaged  to  reduce  the  estimates  in  the  variance.
      This  bears  the  penalty  of  reducing  the  longest  period  that  can  be  determined,  but  in  a
      long time series it is often of greater interest to determine the high-frequency component.
      An  R  package  is  available  to  accomplish  this  smoothing,  which  is  often  called  &#8220;Welch
      smoothing&#8221;: <span 
class="ectt-1200">bspec::welchPSD(). </span>The package &#8220;bspec&#8221; may need to be downloaded from
      the standard CRAN repository because it is not part of the standard R routines. The length
      of the (overlapping) segments to use can be specified in the function call.
      </li>
      <li 
  class="enumerate" id="x1-8006x3">Binning and averaging. Another option is simply to combine estimates in bins into a single
      mean estimate that represents that bin. This can be particularly useful in the case of displays
      with logarithmic abscissas, because bins can be defined in equal logarithmic intervals to span
      equal abscissa distances on a logarithmic plot.</li></ol>
<!--l. 572--><p class="noindent" ><hr class="figure"><div class="figure" 
><a 
 id="x1-80075"></a>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;5: </span><span  
class="content">Examples of smoothed spectra, all based on the time series and periodigram in Fig.
4.  (top)  Daniell  smoothing,  length=49;  (middle)  Welch  smoothing,  segment  length=512  days;
(bottom) bin averaging, 200 logarithmically spaced bins.</span></div><!--tex4ht:label?: x1-80075 -->
<!--l. 579--><p class="noindent" ></div><hr class="endfigure">
<!--l. 584--><p class="noindent" >Examples of each of these methods are shown in Fig.&#x00A0;<a 
href="#x1-80075">5<!--tex4ht:ref: fig:smoothOptions --></a>. The degree of smoothing has a strong effect on
the diurnal peaks because they are so limited in frequency, so too much smoothing caused spectral
resolution to deteriorate.
<!--l. 589--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.4    </span> <a 
 id="x1-90003.4"></a>The &#8220;maximum entropy&#8221; method of estimating the variance spectrum</h4>
<!--l. 591--><p class="noindent" >An alternative to the traditional FFT approach is provided by the algorithm developed by
Burg and sometimes called the maximum entropy method (MEM). A numerical approach,
described in detail in &#8220;Numerical Recipes in C&#8221;, won&#8217;t be discussed here. An R routine that
calculates the spectral variance is contained in the &#8220;Ranadu&#8221; package in the file &#8220;mem.R&#8221;. That file
contains two functions, one for generating the coefficients that represent the spectrum and
the other for evaluating the spectrum at a specific frequency using those coefficients. The
following section of R code illustrates how these functions are used, and Fig.&#x00A0;<a 
href="#x1-90016">6<!--tex4ht:ref: fig:mem --></a> shows an
example.
<div  
class="centerline"><span 
class="colorbox" id="colorbox186"><div class="alltt">
                                                                                         </span></div>
                                                                                         
                                                                                         
<div  
class="centerline"><span 
class="colorbox" id="colorbox188"><!--l. 604--><p class="noindent" ><div class="obeylines-v">
<span id="textcolor7"><span 
class="ecit-1200">##</span><span 
class="ecit-1200">&#x00A0;This</span><span 
class="ecit-1200">&#x00A0;needs</span><span 
class="ecit-1200">&#x00A0;lib(Ranadu),</span><span 
class="ecit-1200">&#x00A0;loaded</span><span 
class="ecit-1200">&#x00A0;earlier</span></span>
<br /><span id="textcolor8"><span 
class="ecit-1200">##</span><span 
class="ecit-1200">&#x00A0;The</span><span 
class="ecit-1200">&#x00A0;data.frame</span><span 
class="ecit-1200">&#x00A0;DIA</span><span 
class="ecit-1200">&#x00A0;was</span><span 
class="ecit-1200">&#x00A0;generated</span><span 
class="ecit-1200">&#x00A0;previously</span><span 
class="ecit-1200">&#x00A0;from</span><span 
class="ecit-1200">&#x00A0;the</span><span 
class="ecit-1200">&#x00A0;hourly</span><span 
class="ecit-1200">&#x00A0;observations.</span></span>
<br /><span id="textcolor9"><span 
class="ecit-1200">##</span><span 
class="ecit-1200">&#x00A0;The</span><span 
class="ecit-1200">&#x00A0;sea-level</span><span 
class="ecit-1200">&#x00A0;pressure</span><span 
class="ecit-1200">&#x00A0;is</span><span 
class="ecit-1200">&#x00A0;saved</span><span 
class="ecit-1200">&#x00A0;in</span><span 
class="ecit-1200">&#x00A0;the</span><span 
class="ecit-1200">&#x00A0;variable</span><span 
class="ecit-1200">&#x00A0;SLVP.</span></span>
<br /><span id="textcolor10"><span 
class="ecit-1200">##</span><span 
class="ecit-1200">&#x00A0;Replace</span><span 
class="ecit-1200">&#x00A0;missing</span><span 
class="ecit-1200">&#x00A0;values</span><span 
class="ecit-1200">&#x00A0;by</span><span 
class="ecit-1200">&#x00A0;interpolation:</span></span>
<br /><span id="textcolor11"><span 
class="ectt-1200">SLVP</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor12"><span 
class="ectt-1200">&#x003C;-</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor13"><span 
class="ectt-1200">SmoothInterp</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor14"><span 
class="ectt-1200">(DIA</span></span><span id="textcolor15"><span 
class="ectt-1200">$</span></span><span id="textcolor16"><span 
class="ectt-1200">SLVP,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor17"><span 
class="ectt-1200">.Length</span></span><span id="textcolor18"><span 
class="ectt-1200">=</span></span><span id="textcolor19"><span 
class="ectt-1200">0</span></span><span id="textcolor20"><span 
class="ectt-1200">)</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor21"><span 
class="ecit-1200">##</span><span 
class="ecit-1200">&#x00A0;.Length=0</span><span 
class="ecit-1200">&#x00A0;suppresses</span><span 
class="ecit-1200">&#x00A0;smoothing</span></span>
<br /><span id="textcolor22"><span 
class="ectt-1200">SLVP[</span></span><span id="textcolor23"><span 
class="ectt-1200">83304</span></span><span id="textcolor24"><span 
class="ectt-1200">]</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor25"><span 
class="ectt-1200">&#x003C;-</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor26"><span 
class="ectt-1200">SLVP[</span></span><span id="textcolor27"><span 
class="ectt-1200">83303</span></span><span id="textcolor28"><span 
class="ectt-1200">]</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor29"><span 
class="ecit-1200">##</span><span 
class="ecit-1200">&#x00A0;the</span><span 
class="ecit-1200">&#x00A0;last</span><span 
class="ecit-1200">&#x00A0;value</span><span 
class="ecit-1200">&#x00A0;has</span><span 
class="ecit-1200">&#x00A0;a</span><span 
class="ecit-1200">&#x00A0;false</span><span 
class="ecit-1200">&#x00A0;0,</span><span 
class="ecit-1200">&#x00A0;so</span><span 
class="ecit-1200">&#x00A0;replace</span><span 
class="ecit-1200">&#x00A0;it</span></span>
<br /><span id="textcolor30"><span 
class="ectt-1200">MEMc50</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor31"><span 
class="ectt-1200">&#x003C;-</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor32"><span 
class="ectt-1200">memCoef</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor33"><span 
class="ectt-1200">(SLVP,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor34"><span 
class="ectt-1200">.poles</span></span><span id="textcolor35"><span 
class="ectt-1200">=</span></span><span id="textcolor36"><span 
class="ectt-1200">50</span></span><span id="textcolor37"><span 
class="ectt-1200">)</span></span>
<br /><span id="textcolor38"><span 
class="ectt-1200">MEMc300</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor39"><span 
class="ectt-1200">&#x003C;-</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor40"><span 
class="ectt-1200">memCoef</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor41"><span 
class="ectt-1200">(SLVP,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor42"><span 
class="ectt-1200">.poles</span></span><span id="textcolor43"><span 
class="ectt-1200">=</span></span><span id="textcolor44"><span 
class="ectt-1200">300</span></span><span id="textcolor45"><span 
class="ectt-1200">)</span></span>
<br /><span id="textcolor46"><span 
class="ectt-1200">lf</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor47"><span 
class="ectt-1200">&#x003C;-</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor48"><span 
class="ectt-1200">seq</span></span><span id="textcolor49"><span 
class="ectt-1200">(</span></span><span id="textcolor50"><span 
class="ectt-1200">-</span></span><span id="textcolor51"><span 
class="ectt-1200">2</span></span><span id="textcolor52"><span 
class="ectt-1200">,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor53"><span 
class="ectt-1200">1</span></span><span id="textcolor54"><span 
class="ectt-1200">,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor55"><span 
class="ectt-1200">by</span></span><span id="textcolor56"><span 
class="ectt-1200">=</span></span><span id="textcolor57"><span 
class="ectt-1200">0.00001</span></span><span id="textcolor58"><span 
class="ectt-1200">)</span></span>
<br /><span id="textcolor59"><span 
class="ectt-1200">freq</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor60"><span 
class="ectt-1200">&#x003C;-</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor61"><span 
class="ectt-1200">10</span></span><span id="textcolor62"><span 
class="ectt-1200">^</span></span><span id="textcolor63"><span 
class="ectt-1200">lf</span></span>
<br /><span id="textcolor64"><span 
class="ectt-1200">Rate</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor65"><span 
class="ectt-1200">&#x003C;-</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor66"><span 
class="ectt-1200">24</span></span>
<br /><span id="textcolor67"><span 
class="ectt-1200">Pmem</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor68"><span 
class="ectt-1200">&#x003C;-</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor69"><span 
class="ectt-1200">memEstimate</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor70"><span 
class="ectt-1200">(freq</span></span><span id="textcolor71"><span 
class="ectt-1200">/</span></span><span id="textcolor72"><span 
class="ectt-1200">Rate,</span><span 
class="ectt-1200">&#x00A0;MEMc300)</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor73"><span 
class="ectt-1200">/</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor74"><span 
class="ectt-1200">Rate</span></span>
<br /><span id="textcolor75"><span 
class="ectt-1200">Pmem50</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor76"><span 
class="ectt-1200">&#x003C;-</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor77"><span 
class="ectt-1200">memEstimate</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor78"><span 
class="ectt-1200">(freq</span></span><span id="textcolor79"><span 
class="ectt-1200">/</span></span><span id="textcolor80"><span 
class="ectt-1200">Rate,</span><span 
class="ectt-1200">&#x00A0;MEMc50)</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor81"><span 
class="ectt-1200">/</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor82"><span 
class="ectt-1200">Rate</span></span>
<br /><span id="textcolor83"><span 
class="ectt-1200">Pmem</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor84"><span 
class="ectt-1200">&#x003C;-</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor85"><span 
class="ectt-1200">2</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor86"><span 
class="ectt-1200">*</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor87"><span 
class="ectt-1200">Rate</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor88"><span 
class="ectt-1200">*</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor89"><span 
class="ectt-1200">Mod</span></span><span id="textcolor90"><span 
class="ectt-1200">(Pmem)</span></span><span id="textcolor91"><span 
class="ectt-1200">^</span></span><span id="textcolor92"><span 
class="ectt-1200">2</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor93"><span 
class="ecit-1200">##</span><span 
class="ecit-1200">&#x00A0;The</span><span 
class="ecit-1200">&#x00A0;returned</span><span 
class="ecit-1200">&#x00A0;spectrum</span><span 
class="ecit-1200">&#x00A0;is</span><span 
class="ecit-1200">&#x00A0;complex</span></span>
<br /><span id="textcolor94"><span 
class="ectt-1200">Pmem50</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor95"><span 
class="ectt-1200">&#x003C;-</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor96"><span 
class="ectt-1200">2</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor97"><span 
class="ectt-1200">*</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor98"><span 
class="ectt-1200">Rate</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor99"><span 
class="ectt-1200">*</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor100"><span 
class="ectt-1200">Mod</span></span><span id="textcolor101"><span 
class="ectt-1200">(Pmem50)</span></span><span id="textcolor102"><span 
class="ectt-1200">^</span></span><span id="textcolor103"><span 
class="ectt-1200">2</span></span>
<br /><span id="textcolor104"><span 
class="ectt-1200">plot</span></span><span id="textcolor105"><span 
class="ectt-1200">(freq,</span><span 
class="ectt-1200">&#x00A0;Pmem,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor106"><span 
class="ectt-1200">type</span></span><span id="textcolor107"><span 
class="ectt-1200">=</span></span><span id="textcolor108"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">l</span><span 
class="tctt-1200">'</span></span><span id="textcolor109"><span 
class="ectt-1200">,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor110"><span 
class="ectt-1200">log</span></span><span id="textcolor111"><span 
class="ectt-1200">=</span></span><span id="textcolor112"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">xy</span><span 
class="tctt-1200">'</span></span><span id="textcolor113"><span 
class="ectt-1200">,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor114"><span 
class="ectt-1200">col</span></span><span id="textcolor115"><span 
class="ectt-1200">=</span></span><span id="textcolor116"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">blue</span><span 
class="tctt-1200">'</span></span><span id="textcolor117"><span 
class="ectt-1200">,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor118"><span 
class="ectt-1200">lwd</span></span><span id="textcolor119"><span 
class="ectt-1200">=</span></span><span id="textcolor120"><span 
class="ectt-1200">2</span></span><span id="textcolor121"><span 
class="ectt-1200">,</span></span>
<br /><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor122"><span 
class="ectt-1200">ylim</span></span><span id="textcolor123"><span 
class="ectt-1200">=</span></span><span id="textcolor124"><span 
class="ectt-1200">c</span></span><span id="textcolor125"><span 
class="ectt-1200">(</span></span><span id="textcolor126"><span 
class="ectt-1200">1.e-2</span></span><span id="textcolor127"><span 
class="ectt-1200">,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor128"><span 
class="ectt-1200">1.e3</span></span><span id="textcolor129"><span 
class="ectt-1200">),</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor130"><span 
class="ectt-1200">xlim</span></span><span id="textcolor131"><span 
class="ectt-1200">=</span></span><span id="textcolor132"><span 
class="ectt-1200">c</span></span><span id="textcolor133"><span 
class="ectt-1200">(</span></span><span id="textcolor134"><span 
class="ectt-1200">1.e-2</span></span><span id="textcolor135"><span 
class="ectt-1200">,</span></span><span id="textcolor136"><span 
class="ectt-1200">10</span></span><span id="textcolor137"><span 
class="ectt-1200">),</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor138"><span 
class="ectt-1200">xlab</span></span><span id="textcolor139"><span 
class="ectt-1200">=</span></span><span id="textcolor140"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">frequency</span><span 
class="ectt-1200">&#x00A0;[/day]</span><span 
class="tctt-1200">'</span></span><span id="textcolor141"><span 
class="ectt-1200">,</span></span>
<br /><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor142"><span 
class="ectt-1200">ylab</span></span><span id="textcolor143"><span 
class="ectt-1200">=</span></span><span id="textcolor144"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">fP(f)</span><span 
class="tctt-1200">'</span></span><span id="textcolor145"><span 
class="ectt-1200">)</span></span>
<br /><span id="textcolor146"><span 
class="ectt-1200">lines</span></span><span id="textcolor147"><span 
class="ectt-1200">(freq,</span><span 
class="ectt-1200">&#x00A0;Pmem50,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor148"><span 
class="ectt-1200">col</span></span><span id="textcolor149"><span 
class="ectt-1200">=</span></span><span id="textcolor150"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">forestgreen</span><span 
class="tctt-1200">'</span></span><span id="textcolor151"><span 
class="ectt-1200">,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor152"><span 
class="ectt-1200">lwd</span></span><span id="textcolor153"><span 
class="ectt-1200">=</span></span><span id="textcolor154"><span 
class="ectt-1200">2</span></span><span id="textcolor155"><span 
class="ectt-1200">)</span></span>
<br /><span id="textcolor156"><span 
class="ectt-1200">legend</span></span><span id="textcolor157"><span 
class="ectt-1200">(</span></span><span id="textcolor158"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">topright</span><span 
class="tctt-1200">'</span></span><span id="textcolor159"><span 
class="ectt-1200">,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor160"><span 
class="ectt-1200">legend</span></span><span id="textcolor161"><span 
class="ectt-1200">=</span></span><span id="textcolor162"><span 
class="ectt-1200">c</span></span><span id="textcolor163"><span 
class="ectt-1200">(</span></span><span id="textcolor164"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">50</span><span 
class="ectt-1200">&#x00A0;poles</span><span 
class="tctt-1200">'</span></span><span id="textcolor165"><span 
class="ectt-1200">,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor166"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">300</span><span 
class="ectt-1200">&#x00A0;poles</span><span 
class="tctt-1200">'</span></span><span id="textcolor167"><span 
class="ectt-1200">),</span></span>
<br /><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor168"><span 
class="ectt-1200">col</span></span><span id="textcolor169"><span 
class="ectt-1200">=</span></span><span id="textcolor170"><span 
class="ectt-1200">c</span></span><span id="textcolor171"><span 
class="ectt-1200">(</span></span><span id="textcolor172"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">forestgreen</span><span 
class="tctt-1200">'</span></span><span id="textcolor173"><span 
class="ectt-1200">,</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor174"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">blue</span><span 
class="tctt-1200">'</span></span><span id="textcolor175"><span 
class="ectt-1200">),</span></span><span 
class="ectt-1200">&#x00A0;</span><span id="textcolor176"><span 
class="ectt-1200">lwd</span></span><span id="textcolor177"><span 
class="ectt-1200">=</span></span><span id="textcolor178"><span 
class="ectt-1200">c</span></span><span id="textcolor179"><span 
class="ectt-1200">(</span></span><span id="textcolor180"><span 
class="ectt-1200">2</span></span><span id="textcolor181"><span 
class="ectt-1200">,</span></span><span id="textcolor182"><span 
class="ectt-1200">2</span></span><span id="textcolor183"><span 
class="ectt-1200">))</span></span>
</div>
</div>                                                                                         </span></div>-
<!--l. 627--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-90016"></a>
                                                                                         
                                                                                         
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;6: </span><span  
class="content">Variance spectrum generated by the maximum-entropy algorithm, for the same time
series shown in the previous three plots. The blue-line spectrum is that obtained using 300 poles,
while  the  green-line  spectrum  was  obtained  using  50  poles.  Both  were  evaluated  at  300,000
frequencies from 0.01 to 10 day<sup><span 
class="zptmcm7y-x-x-90">-</span><span 
class="zptmcm7t-x-x-90">1</span></sup>.</span></div><!--tex4ht:label?: x1-90016 -->
                                                                                         
                                                                                         
<!--l. 634--><p class="noindent" ></div><hr class="endfigure">
                                                                                         
                                                                                         
<!--l. 641--><p class="noindent" >No smoothing has been applied to this variance spectrum, but it still appears smooth. Smoothing is
accomplished by using a smaller number of poles. Sometimes spectral features, like those of the diurnal
cycle, can be very sharp, so it is necessary to use high resolution and a modest number of poles (&#x003E;100) in
searches for such features. In this case, using 50 poles for example produces the smoothed spectrum
shown as the dashed green line that misses the diurnal-cycle peak entirely, even with fine-resolution
evaluation. Evaluation with large numbers of poles (e.g., &#x003E;400) can require an impractically long
processing time.
                                                                                         
                                                                                         
<div class="center" 
>
<!--l. 654--><p class="noindent" >
<!--l. 655--><p class="noindent" ><span id="textcolor189"><span 
class="ecss-1200">&#8211; End of Memo &#8211;</span></span>
</div>
<!--l. 658--><p class="noindent" >Reproducibility:  
</body></html> 

                                                                                         


